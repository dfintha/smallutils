#include <chrono>
#include <curses.h>
#include <iostream>
#include <locale.h>
#include <thread>

static const char *bunnies =
    "                              ▓▓▓▓▓▓    ▓▓▓▓▓▓                                                    ▓▓▓▓▓▓    ▓▓▓▓▓▓\n"
    "                            ▓▓      ▓▓▓▓      ▓▓                                                ▓▓░░░░░░▓▓▓▓░░░░░░▓▓\n"
    "                            ▓▓░░      ▓▓      ▓▓                                                ▓▓░░░░░░▓▓░░░░░░██▓▓\n"
    "                            ▓▓░░░░    ▓▓        ▓▓                                            ▓▓░░░░░░░░▓▓░░░░████▓▓\n"
    "                              ▓▓░░░░    ▓▓      ▓▓                                            ▓▓░░░░░░▓▓░░░░████▓▓\n"
    "                              ▓▓░░░░    ▓▓      ▓▓                                            ▓▓░░░░░░▓▓░░░░████▓▓\n"
    "                                ▓▓░░░░    ▓▓      ▓▓                                        ▓▓░░░░░░▓▓░░░░████▓▓\n"
    "                                ▓▓░░░░    ▓▓      ▓▓                                        ▓▓░░░░░░▓▓░░░░████▓▓\n"
    "                                  ▓▓░░░░    ▓▓    ▓▓                                        ▓▓░░░░▓▓░░░░████▓▓\n"
    "                                  ▓▓░░░░    ▓▓    ░░▓▓                                    ▓▓░░░░░░▓▓░░░░████▓▓\n"
    "                                    ▓▓░░░░    ▓▓▓▓    ▓▓▓▓                            ▓▓▓▓░░░░▓▓▓▓░░░░████▓▓\n"
    "                                    ▓▓░░░░                ▓▓                        ▓▓░░░░░░░░░░░░░░░░████▓▓\n"
    "                ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓      ▓▓                    ▓▓                    ▓▓░░░░░░░░░░░░░░░░░░░░▓▓      ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓\n"
    "            ▓▓▓▓                ▓▓▓▓  ▓▓                      ▓▓                ▓▓░░░░░░░░░░░░░░░░░░░░░░▓▓  ▓▓▓▓░░░░░░░░░░░░░░░░▓▓▓▓\n"
    "          ▓▓                        ▓▓              ████      ▓▓                ▓▓░░░░░░░████░░░░░░░░░░░░░▓▓░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "        ▓▓                                          ████        ▓▓            ▓▓░░░░░░░░░████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "      ▓▓                                                      ░░▓▓            ▓▓░░▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "    ▓▓                                                          ▓▓            ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "    ▓▓                                                          ▓▓            ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                        ░░              ▓▓▓▓                ▓▓▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                          ░░░░░░░░▓▓▓▓▓▓                        ▓▓▓▓▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                                ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                                ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                                ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                                ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                                ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "  ▓▓                                                ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "    ▓▓    ░░          ░░░░░░░░                      ░░▓▓                                ▓▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "    ▓▓      ░░        ▓▓▓▓▓▓▓▓░░              ▓▓  ░░▓▓                                    ▓▓░░░░▓▓░░░░░░░░░░░░░░░░▓▓▓▓▓▓▓▓▓▓░░░░░░░░░░░░░░▓▓\n"
    "      ▓▓    ░░                ▓▓░░            ▓▓░░░░▓▓                                    ▓▓░░░░▓▓░░░░░░░░░░░░░░▓▓░░░░░░░░░░░░░░░░░░░░░░▓▓\n"
    "        ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓                                        ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓\n";

static const char *heart[] = {
    "          ",
    "          ",
    "▓▓▓▓  ▓▓▓▓",
    "▓▓▓▓▓▓▓▓▓▓",
    "  ▓▓▓▓▓▓  ",
    "    ▓▓    ",
    "          ",
    "          "
};

int main(void) {
    setlocale(LC_ALL, "");
    const WINDOW *terminal = initscr();
    const int image_width = 144;
    const int image_height = 31;
    const int total_width = getmaxx(terminal);
    const int total_height = getmaxy(terminal);
    const int needed_width = image_width + 4;
    const int needed_height = total_height + 2;
    if (total_width < needed_width || total_height < image_height + 2) {
        endwin();
        std::cerr << "Terminal resolution needs to be larger or equal than "
                  << needed_width << 'x' << needed_height << '!'
                  << std::endl;
        return 1;
    }

    noecho();
    curs_set(0);
    const int left = (total_width - image_width) / 2;
    const int top = (total_height - image_height) / 2;
    WINDOW *window = newwin(image_height, image_width, top, left);

    int frame = 0;
    while (true) {
        const int top = (frame % 2 == 0) ? 0 : 1;
        mvwprintw(window, 0, 0, "%s", bunnies);
        for (int i = 0; i < 8; ++i) {
            mvwprintw(window, top + i, 67, "%s", heart[i]);
        }
        refresh();
        wrefresh(window);
        ++frame;
        std::this_thread::sleep_for(std::chrono::seconds(1));
    }

    endwin();
    return 0;
}
